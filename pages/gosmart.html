<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Go Smart Tecnologia</title>
</head>

<body>
        <nav class="navbar navbar-light" style="background-color: #6E4D8B;">
                <a class="navbar-brand" href="#">
                    <img alt="Go Smart Tecnologia" src="../images/logo_gosmart.PNG">
                </a>
            </nav>
    <div class="container">
        <br>
            <div class="col-12">
                <div class="row">               
                    <div class="col-md-6">
                        <div class="form-group form-row">
                            <label class="sr-only" for="certificado">Tipo de Certificado:</label>
                            <div class="input-group mb-2 mr-sm-2">
                                <div class="input-group-prepend">
                                <div class="input-group-text">Tipo de Certificado</div>
                                </div>
                                <select class="form-control" id="certificado" onchange="SetarValores();">
                                        <option>Nenhum selecionado</option>
                                        <option>Certificado e-CNPJ A1 - 1 ano</option>
                                        <option>Certificado e-CNPJ A3 - 3 anos</option>
                                        <option>Certificado e-CPF A1 - 1 ano</option>
                                        <option>Certificado e-CPF A3 - 3 anos</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group d-none" id="local">
                            <label class="sr-only" for="delivery">Local/Delivery:</label>
                            <div class="input-group mb-2 mr-sm-2">
                                <div class="input-group-prepend">
                                <div class="input-group-text">Local/Delivery</div>
                                </div>
                                <select class="form-control" id="delivery" onchange="SetarValores();">
                                    <option value="0">Escritório Go Smart (Neópolis) - R$ 0,00</option>
                                    <option value="20">Delivery Natal - R$ 20,00</option>
                                    <option value="30">Delivery Natal Zona Norte - R$ 30,00</option>
                                    <option value="25">Delivery Parnamirim - R$ 25,00</option>
                                </select>
                            </div>
                        </div>
                        <div class="input-group mb-3 d-none" id="calcular">
                            <input id="seu_preco" type="text" class="form-control" placeholder="Informe seu preço">
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary" type="button" id="button"
                                onclick="CalcularComissao()">Calcular</button>
                            </div>
                            <div class="valid-feedback">
                                Tudo certo, para aumentar sua comissão aumente o valor.
                            </div>
                            <div class="invalid-feedback">
                                O valor foi reajustado para o preço mínimo.
                            </div>
                        </div>
                        <div class="form-group d-none" id="comissao">
                            <table class="table table-hover " id="tableValores">
                                <tbody>
                                    <tr>
                                        <th scope="row">Preço Certificado GoSmart</th>
                                            <td id="nosso_preco" class="text-right"></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Preço Delivery</th>
                                            <td id="valorDelivery" class="text-right"></td>
                                    </tr>
                                    <tr class="table-success">
                                        <th scope="row">Sua comissão</th>
                                            <td id="suacomissao" class="text-right"></td>
                                    </tr>
                                    <tr class="table-danger">
                                        <th scope="row">Valor Total</th>
                                            <td id="total" class="text-right"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <table class="table table-hover table-striped d-none table-sm" id="tableParcelas">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col"></th>
                                        <th scope="col" class="text-right">Total</th>
                                        <th scope="col" class="text-right">Parcela</th>
                                    </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">Débito</th>
                                        <td id="total0x" class="text-right"></td>
                                        <td id="parcela0x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">1x Cartão de crédito</th>
                                        <td id="total1x" class="text-right"></td>
                                        <td id="parcela1x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">2x Cartão de crédito</th>
                                        <td id="total2x" class="text-right"></td>
                                        <td id="parcela2x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">3x Cartão de crédito</th>
                                        <td id="total3x" class="text-right"></td>
                                        <td id="parcela3x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">4x Cartão de crédito</th>
                                        <td id="total4x" class="text-right"></td>
                                        <td id="parcela4x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">5x Cartão de crédito</th>
                                        <td id="total5x" class="text-right"></td>
                                        <td id="parcela5x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">6x Cartão de crédito</th>
                                        <td id="total6x" class="text-right"></td>
                                        <td id="parcela6x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">7x Cartão de crédito</th>
                                        <td id="total7x" class="text-right"></td>
                                        <td id="parcela7x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">8x Cartão de crédito</th>
                                        <td id="total8x" class="text-right"></td>
                                        <td id="parcela8x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">9x Cartão de crédito</th>
                                        <td id="total9x" class="text-right"></td>
                                        <td id="parcela9x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">10x Cartão de crédito</th>
                                        <td id="total10x" class="text-right"></td>
                                        <td id="parcela10x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">11x Cartão de crédito</th>
                                        <td id="total11x" class="text-right"></td>
                                        <td id="parcela11x" class="text-right"></td>
                                </tr>
                                <tr>
                                    <th scope="row">12x Cartão de crédito</th>
                                        <td id="total12x" class="text-right"></td>
                                        <td id="parcela12x" class="text-right"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
<script language="javascript">
    const precos = [
    {
        preco: 0,
        precosugerido: 0,
        descricaoCertificado: "Nenhum certificado selecionado"
    },
    {
        preco: 176,
        precosugerido: 219.9,
        descricaoCertificado: "Certificado e-CNPJ A1 - 1 ano"
    },
    {
        preco: 264,
        precosugerido: 329.9,
        descricaoCertificado: "Certificado e-CNPJ A3 - 3 anos"
    },
    {
        preco: 136,
        precosugerido: 159.9,
        descricaoCertificado: "Certificado e-CPF A1 - 1 ano"
    },
    {
        preco: 212.5,
        precosugerido: 249.9,
        descricaoCertificado: "Certificado e-CPF A3 - 3 anos"
    }
]    
    var nossopreco = 0;
    var valorDelivery = 0;
    var soma = 0;
    function SetarValores() {
        var certificado = document.getElementById("certificado");
        var valorCertificado = certificado.options[certificado.selectedIndex].index;
        var tipoCertificado = certificado.options[certificado.selectedIndex].index;

        delivery = document.getElementById("delivery");
        valorDelivery = delivery.options[delivery.selectedIndex].value;

        nossopreco = precos[tipoCertificado].preco;
        var descricao = precos[tipoCertificado].descricaoCertificado;

        soma = parseFloat(nossopreco) + parseFloat(valorDelivery);
        if (certificado.selectedIndex > 0) {
            nossopreco = soma;
        }
        //document.getElementById("nosso_preco").innerHTML = "R$ " + formatarValores(nossopreco) +
        //" ( R$" + formatarValores(nossopreco) + " do certificado +" + 
        //" R$ " + formatarValores(valorDelivery) + " do Delivery)";
         AjustarLayout();
    }
    function CalcularComissao() {
            var seupreco = parseFloat(document.getElementById("seu_preco").value) || 0;

            document.getElementById("seu_preco").classList.remove("is-invalid");
            document.getElementById("seu_preco").classList.remove("is-valid");

            if (seupreco < nossopreco)
            {
                document.getElementById("seu_preco").classList.add("is-invalid");
                seupreco = nossopreco;
                document.getElementById("seu_preco").value = formatarValores(seupreco);
            } else {
                document.getElementById("seu_preco").classList.add("is-valid");
            }
            sua_comissao = seupreco - nossopreco;
            if (sua_comissao < 0) {
                seupreco = nossopreco;
                sua_comissao = 0
            }
            if (seupreco > 0) {
                var fator = [1.0239, 1.0550, 1.1100, 1.1282, 1.1464, 1.1646, 1.1828, 1.2010, 1.2192, 1.2374, 1.2556, 1.2738, 1.2920]
                for (var i = 0; i < 13; i++) {
                    var valorTotal = seupreco * fator[i];
                    var valorParcela = valorTotal / i;
                    if (i == 0) { valorParcela = valorTotal }
                    document.getElementById("total" + i + "x").innerHTML = 'R$ ' + formatarValores(valorTotal);
                    document.getElementById("parcela" + i + "x").innerHTML = 'R$ ' + formatarValores(valorParcela);
                }
                document.getElementById("tableParcelas").classList.remove("d-none");
                document.getElementById("comissao").classList.remove("d-none");
            } else {
                document.getElementById("tableParcelas").classList.add("d-none");
            }
            document.getElementById("nosso_preco").innerHTML = 'R$ ' + formatarValores(nossopreco - valorDelivery);
            document.getElementById("valorDelivery").innerHTML = 'R$ ' + formatarValores((valorDelivery));
            document.getElementById("suacomissao").innerHTML = 'R$' + formatarValores(sua_comissao);
            document.getElementById("total").innerHTML = 'R$' + formatarValores(seupreco);
        }
    function formatarValores(x) {
        x = parseFloat(x);
        return x.toLocaleString("pt-BR", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    $(document).ready(function () {
        $('#seu_preco').keypress(function (e) {
            if (e.keyCode == 13)
                $('#button').click();
        });
        
    });
    function AjustarLayout () {
        if($('#certificado').prop('selectedIndex') > 0){
            $('#local').removeClass("d-none");
                $('#calcular').removeClass("d-none");
        } else {
            $('#local').addClass("d-none");
            $('#calcular').addClass("d-none");
        }
    }
</script>

</html>